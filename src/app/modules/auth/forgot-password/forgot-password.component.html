<div *ngIf="state$ | async as state">
  <p class="text-2xl font-extrabold leading-tight tracking-tight">Mot de passe oublié</p>
  <div class="mt-0.5 flex items-baseline font-medium">
    <div>Mot de passe?</div>
    <a class="ml-1 text-primary-500 hover:underline" [routerLink]="['/sign-in']">Se connecter</a>
  </div>

  @if (!state.error && !(state.errors.length > 0)) {
    <fuse-alert class="mt-8" [appearance]="'outline'" [showIcon]="true" [type]="'info'" [@shake]="true">
      Un code de réinitialisation vous sera envoyé par e-mail.
    </fuse-alert>
  }

  @if (state.error || state.errors.length > 0) {
    <fuse-alert class="mt-8" [appearance]="'outline'" [showIcon]="true" [type]="'error'" [@shake]="true">
      {{ state.error }}
      <span *ngIf="state.errors.length > 0">{{ state.errors | APIValidationError }}</span>
    </fuse-alert>
  }

  <form class="mt-8" [formGroup]="forgotPasswordForm">
    <mat-form-field class="w-full">
      <mat-label>Adresse e-mail</mat-label>
      <input id="email" autocomplete="email" matInput formControlName="email" />
    </mat-form-field>

    <button
      class="fuse-mat-button-large mt-6 w-full text-white"
      mat-flat-button
      [color]="'primary'"
      [disabled]="state.isLoading || forgotPasswordForm.invalid"
      (click)="sendResetToken()">
      @if (!state.isLoading && !forgotPasswordForm.invalid) {
        <span>Envoyer le code</span>
      }
      @if (state.isLoading) {
        <mat-progress-spinner [diameter]="24" [mode]="'indeterminate'"></mat-progress-spinner>
      }
    </button>
  </form>
</div>
